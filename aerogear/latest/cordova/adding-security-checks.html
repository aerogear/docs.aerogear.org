<!DOCTYPE html>
<html lang="en">
  <head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script>
function addBlockSwitches() {
	$('.primary').each(function() {
		primary = $(this);
		createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
		primary.children('.title').remove();
	});
	$('.secondary').each(function(idx, node) {
		secondary = $(node);
		primary = findPrimary(secondary);
		switchItem = createSwitchItem(secondary, primary.children('.switch'));
		switchItem.content.addClass('hidden');
		findPrimary(secondary).append(switchItem.content);
		secondary.remove();
	});
}

function createBlockSwitch(primary) {
	blockSwitch = $('<div class="switch"></div>');
	primary.prepend(blockSwitch);
	return blockSwitch;
}

function findPrimary(secondary) {
	candidate = secondary.prev();
	while (!candidate.is('.primary')) {
		candidate = candidate.prev();
	}
	return candidate;
}

function createSwitchItem(block, blockSwitch) {
	blockName = block.children('.title').text();
	content = block.children('.content').first().append(block.next('.colist'));
	item = $('<div class="switch--item">' + blockName + '</div>');
	item.on('click', '', content, function(e) {
		$(this).addClass('selected');
		$(this).siblings().removeClass('selected');
		e.data.siblings('.content').addClass('hidden');
		e.data.removeClass('hidden');
	});
	blockSwitch.append(item);
	return {'item': item, 'content': content};
}

$(addBlockSwitches);    
</script>


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled :: AeroGear Mobile Services</title>
    <link rel="canonical" href="https://www.aerogear.org/aerogear/latest/cordova/adding-security-checks.html">
    <meta name="generator" content="Antora 1.0.1">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.aerogear.org">AeroGear Mobile Services</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">

    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="aerogear" data-version="latest">
  <aside class="navigation" role="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">AeroGear Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../index.html">Getting Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../registering-a-mobile-app.html">Registering a Mobile App</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuring-dev-env.html">Dev Environment Setup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../con_services.html">Mobile Services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../keycloak/index.html">Identity Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/binding.html">Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/coding.html">Coding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/authenticating.html">User Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/retrieving-users-roles.html">Access Control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/sso.html">Single Sign On</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/monitoring-keycloak.html">Monitoring Identity Management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../security/index.html">Device Security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../security/proc_performing-device-checks.html">Device Trust Checks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../security/proc_pinning-certificates.html">Certificate Pinning</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../push/index.html">Push Notifications</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../push/provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../push/binding.html">Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../push/coding.html">Coding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">More&#8230;&#8203;</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../push/proc_sending-a-push-notification.html">Sending a Push Notification</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../push/admin-ui.html">Unified Push Admin UI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../push/handling-push-notifications.html">Handling Push Notifications</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../push/proc_preparing-ups-for-use-with-ios.html">Apple Push Network</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../push/google-setup.html">Firebase Cloud Messaging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../metrics/index.html">Mobile Metrics</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/binding.html">Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/configuring-dev-env-metrics.html">Coding an App to use Mobile Metrics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/analysing-app-usage.html">Analysing Apps and Devices</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../custom/index.html">Runtime Connector</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../custom/provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../custom/binding.html">Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../custom/configuring-dev-env-custom.html">Using Runtime Connectors in an App</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../digger/index.html">Mobile CI/CD</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../digger/provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../digger/proc_creating-a-build-configuration.html">Creating a Build Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../digger/running-a-build.html">Building Apps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../digger/proc_deploying-a-mobile-app.html">Deploying Apps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../ref_api.html">API Reference</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ref_api.html#android">Android</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ref_api.html#ios">iOS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ref_api.html#cordova">Cordova</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ref_api.html#xamarin">Xamarin</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../showcase-apps/index.html">Showcase Apps</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/service-setup.html">Service Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/identity-management.html">Identity Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/device-security.html">Device Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/push-notifications.html">Push Notifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/metrics.html">Mobile Metrics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mobile-cli.html">Mobile CLI</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">AeroGear Docs</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">AeroGear Docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main" role="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="crumbs" role="navigation" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/aerogear/mobile-docs/edit/master/modules/ROOT/pages/cordova/adding-security-checks.adoc"></a></div>
</div>
<article class="doc">
<div class="sect1">
<h2 id="aerogear-javascript-security-sdk"><a class="anchor" href="#aerogear-javascript-security-sdk"></a>AeroGear JavaScript Security SDK</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AeroGear JavaScript SDK offers a set of security features that will make sure that your application is meeting the modern OWASP recomendations. All security features are available as part of the separate package <code>@aerogear/security</code>. This package offers multiple security checks that can be used to analyse the security of the device. This can be useful for developers to detect vulnerabilities and react accordingly. For example, if the app detects security issue <strong>X</strong> then do <strong>Y</strong>, where <strong>X</strong> could be no lock screen is set and <strong>Y</strong> is show a system prompt to setup the lock screen.</p>
</div>
<div class="paragraph">
<p>This package offers:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A suite of self-defence checks to detect a insecure or hostile environment.</p>
</li>
<li>
<p>Ability to implement custom self-defence checks.</p>
</li>
<li>
<p>Callbacks to access the results of self-defence checks and take appropriate action in application code.</p>
</li>
<li>
<p>Integration with the AeroGear Services Metrics SDK to report self-defence checks data.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="installation"><a class="anchor" href="#installation"></a>Installation</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the Security package, available via NPM:</p>
<div class="listingblock">
<div class="content">
<pre>npm install @aerogear/security</pre>
</div>
</div>
</li>
<li>
<p>Add the AeroGear Security plugin for Cordova:</p>
<div class="listingblock">
<div class="content">
<pre>cordova plugin add cordova-plugin-aerogear-security</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This will install the packages needed with their native dependencies from the NPM registry and properly link all native dependencies to the project&#8217;s cordova Platforms.</p>
</div>
</div>
<div class="sect2">
<h3 id="usage"><a class="anchor" href="#usage"></a>Usage</h3>
<div class="paragraph">
<p>To begin using the self defence checks in your app, you&#8217;ll need to import <code>SecurityService</code> from <code>@aerogear/security</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">import { SecurityService } from '@aerogear/security';</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will also need to retrieve an instance of <code>SecurityService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const securityService = new SecurityService();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="provided-self-defence-checks"><a class="anchor" href="#provided-self-defence-checks"></a>Provided Self Defence Checks</h3>
<div class="paragraph">
<p>The following are the self defence checks provided by the SDK.</p>
</div>
<div class="paragraph">
<p><strong>Important</strong> A successful <code>check</code> means that the environment the application is running in is more secure and no action is required, as opposed to signalling if a certain feature is enabled.</p>
</div>
<div class="paragraph">
<p>For example, the Root Access Detection check <code>notRooted</code> should return <code>true</code> when it is <strong>not</strong> rooted, since this would be the more secure condition.</p>
</div>
<div class="sect3">
<h4 id="emulator-detection-check-notemulated"><a class="anchor" href="#emulator-detection-check-notemulated"></a>Emulator Detection Check (notEmulated)</h4>
<div class="paragraph">
<p>To detect if the app is being run on an emulator the <code>notEmulated</code> function can be used. If the device is <strong>not</strong> running in an emulator then the check will pass.</p>
</div>
</div>
<div class="sect3">
<h4 id="root-access-detection-check-notrooted"><a class="anchor" href="#root-access-detection-check-notrooted"></a>Root Access Detection Check (notRooted)</h4>
<div class="paragraph">
<p>To help prevent your app running in a device that has been rooted/jailbroken the <code>notRooted</code> function can be used. If the device is <strong>not</strong> rooted/jailbroken then the check will pass.</p>
</div>
</div>
<div class="sect3">
<h4 id="debug-mode-check-notdebugmode"><a class="anchor" href="#debug-mode-check-notdebugmode"></a>Debug Mode Check (notDebugMode)</h4>
<div class="paragraph">
<p>To detect if the app is runing in debug mode the <code>notDebugMode</code> function can be used. If the device is <strong>not</strong> running in debug mode then the check will pass.</p>
</div>
</div>
<div class="sect3">
<h4 id="device-lock-check-hasdevicelock"><a class="anchor" href="#device-lock-check-hasdevicelock"></a>Device Lock Check (hasDeviceLock)</h4>
<div class="paragraph">
<p>To detect if a device has a lock screen set the <code>hasDeviceLock</code> function can be used. If the device <strong>has</strong> a screen lock enabled then this check will pass.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For iOS devices this check requires iOS 8 or above.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="custom-self-defence-checks"><a class="anchor" href="#custom-self-defence-checks"></a>Custom Self Defence Checks</h3>
<div class="paragraph">
<p>Custom self defence checks can be used with the Security SDK. Custom self defence checks must implement the <a href="https://github.com/aerogear/aerogear-js-sdk/blob/master/packages/security/src/deviceTrust/SecurityCheck.ts">SecurityCheck</a> interface.</p>
</div>
<div class="paragraph">
<p>An example of a custom check structure in TypeScript:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">class CustomSecurityCheck implements SecurityCheck {
    get name(): string {
        return "My Custom Check";
    }

    public check(): Promise&lt;SecurityCheckResult&gt; {
        // Perform check logic.
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="invoking-a-single-self-defence-check"><a class="anchor" href="#invoking-a-single-self-defence-check"></a>Invoking a Single Self Defence Check</h3>
<div class="paragraph">
<p>The <code>SecurityService.check</code> function is used to invoke a check which returns a promise of type <code>SecurityCheckResult</code>. The <code>check</code> function takes a paramater of type <code>SecurityCheckType</code> which will specify the type of check to be invoked:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">securityService.check(SecurityCheckType.notEmulated).then((result) =&gt; {
    // -&gt; add your logic to handle the result
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="invoking-multiple-self-defence-checks"><a class="anchor" href="#invoking-multiple-self-defence-checks"></a>Invoking Multiple Self Defence Checks</h3>
<div class="paragraph">
<p>To chain multiple checks together the <code>SecurityService.checkMany</code> function is used. This returns an array of <code>SecurityCheckResult</code> objects in the order they`re provided in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const checkResults = await securityService.checkMany(SecurityCheckType.notRooted, SecurityCheckType.notEmulated);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reporting-self-defence-checks-results-via-the-metrics-service"><a class="anchor" href="#reporting-self-defence-checks-results-via-the-metrics-service"></a>Reporting Self Defence Checks Results Via the Metrics Service</h3>
<div class="paragraph">
<p>The results of security checks can be published to the AeroGear metrics service.</p>
</div>
<div class="paragraph">
<p>This functionality requires the cordova plugin @aerogear/cordova-plugin-aerogear-security to be installed.</p>
</div>
<div class="paragraph">
<p>To perform a single check and publish its result to the metrics service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">securityService.checkAndPublishMetric(SecurityCheckType.notRooted).then((result) =&gt; {
    // -&gt; Handle the security result metric.
    // Security result metric structure: { id: 'isRooted', name: 'isRooted', passed: true }.
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>To perform multiple checks and publish their results to the metrics service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">securityService.checkManyAndPublishMetric(SecurityCheckType.notRooted, SecurityCheckType.notEmulated).then((result) =&gt; {
    // -&gt; Handle the array of security result metrics
})</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>This is a preview of the https://docs.aerogear.org website.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script src="../../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
