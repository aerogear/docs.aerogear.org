<!DOCTYPE html>
<html lang="en">
  <head>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-8+rznmq/k0KZkJlZhnuPEVkbRD7tA0wcFEjY48dajGWn3Xc1MasJwS8/tJ7OEsKW" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-1.9.1.min.js" integrity="sha256-wS9gmOZBqsqWxgIVgA8Y9WcQOa7PgSIX+rPA0VL2rbQ=" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js" integrity="sha384-Nud2SriDt2fZ+u85IBC48Yn9p+l4AGlapnX1EGA2KrnZjYJx8sxKnw/CIxc1wU1B" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-url/2.5.3/url.js"></script>
<script>
function addBlockSwitches() {
	$('.primary').each(function() {
		primary = $(this);
		createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
		primary.children('.title').remove();
	});
	$('.secondary').each(function(idx, node) {
		secondary = $(node);
		primary = findPrimary(secondary);
		switchItem = createSwitchItem(secondary, primary.children('.switch'));
		switchItem.content.addClass('hidden');
		findPrimary(secondary).append(switchItem.content);
		secondary.remove();
	});
}

function createBlockSwitch(primary) {
	blockSwitch = $('<div class="switch"></div>');
	primary.prepend(blockSwitch);
	return blockSwitch;
}

function findPrimary(secondary) {
	candidate = secondary.prev();
	while (!candidate.is('.primary')) {
		candidate = candidate.prev();
	}
	return candidate;
}

function createSwitchItem(block, blockSwitch) {
	blockName = block.children('.title').text();
	content = block.children('.content').first().append(block.next('.colist'));
	item = $('<div class="switch--item">' + blockName + '</div>');
	item.on('click', '', content, function(e) {
		$(this).addClass('selected');
		$(this).siblings().removeClass('selected');
		e.data.siblings('.content').addClass('hidden');
		e.data.removeClass('hidden');
	});
	blockSwitch.append(item);
	return {'item': item, 'content': content};
}

$(addBlockSwitches);

Zepto(function($){
	if (url('?header') === 'false') {
		// Hide the navbar for showcase apps (#nochrome)
		$('body').addClass('nochrome');
	}
})
</script>


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using the Identity Management Mobile Service :: AeroGear Mobile Services</title>
    <link rel="canonical" href="https://docs.aerogear.org/aerogear/latest/identity-management.html">
    <meta name="generator" content="Antora 2.0.0">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/index.html">AeroGear</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        
        <li>
          <a href="https://aerogear.org">Home</a>
        </li>

        <li>
          <a href="https://aerogear.org/getting-started/">Getting Started</a>
        </li>

        <li>
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Mobile Services<span class="caret"></span></a>
            <ul class="dropdown-menu" role="menu">
              <li>
                <a href="https://aerogear.org/services/identity-management/">
                  <i class="material-icons" aria-hidden="true">account_circle</i> Identity Management
                </a>
              </li>
              <li>
                <a href="https://aerogear.org/services/push/">
                  <i class="material-icons" aria-hidden="true">notifications_active</i> Push Notifications
                </a>
              </li>
              <li>
                <a href="https://aerogear.org/services/metrics/">
                  <i class="material-icons" aria-hidden="true">insert_chart</i> Mobile Metrics
                </a>
              </li>
              <li>
                <a href="https://aerogear.org/services/mobile-ci-cd/">
                  <i class="material-icons" aria-hidden="true">build</i> Mobile CI/CD
                </a>
              </li>
              <li>
                <a href="https://aerogear.org/services/device-security/">
                  <i class="material-icons" aria-hidden="true">security</i> Device Security
                </a>
              </li>
            </ul>
        </li>

        <li>
          <a href="https://aerogear.org/sdks">Mobile SDKs</a>
        </li>

        <li>
         <a href="https://docs.aerogear.org/">Docs</a>
        </li>
   
        <li>
          <a href="https://aerogear.org/community">Community</a>
        </li>
        

        <li>
          <a href="https://aerogear.org/news">News</a>
        </li>
        
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav><div class="main-wrapper">
<div class="navigation-container" data-component="aerogear" data-version="latest">
  <aside class="navigation" role="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Mobile Services</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="getting-started.html">Getting Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="getting-started.html#introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="getting-started-installing.html">Installing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="getting-started-installing.html#setting-up-aerogear-mobile-services-on-openshift">Setting Up</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="getting-started-installing.html#provision-mdc">Provisioning Mobile Developer Console</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="getting-started-configuring.html">Configuring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="getting-started-configuring.html#registering">Registering a Mobile App</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="getting-started-configuring.html#provisioning">Provisioning a Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="getting-started-configuring.html#binding">Binding Services</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="getting-started-configuring.html#configuring">Configuring Services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="getting-started-running.html">Developing and Running</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="getting-started-running.html#setting-up-your-local-development-environment">Setting Up Development Environment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="getting-started-running.html#running">Running a Mobile App</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="mobile-developer-console.html">Mobile Developer Console</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mobile-developer-console.html#introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mobile-developer-console.html#provision-mdc">Provisioning Mobile Developer Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="mobile-developer-console.html#registering">Registering a Mobile App</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-developer-console.html#sdk">Configure SDK</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mobile-developer-console.html#services">Using mobile services</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mobile-developer-console.html#building">Building Mobile Apps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="con_services.html">Mobile Services</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="identity-management.html">Identity Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#setting-up-the-idm-service">Setting Up</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#adding-user-authentication-to-your-mobile-app">User Authentication</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#access">Access Control</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#adding-sso-to-your-mobile-app">Single Sign On</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#monitoring">Monitoring Identity Management</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="push-notifications.html">Push Notifications</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="push-notifications.html#introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="push-notifications.html#setting-up-the-push-service">Setting Up</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="push-notifications.html#setting-up-the-push-client-app">App configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="push-notifications.html#registering-device">Registering device</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="push-notifications.html#sending-a-push-notification-push">Sending a Notification</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="push-notifications.html#handling-push-notifications-push">Handling a Notification</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="mobile-metrics.html">Mobile Metrics</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-metrics.html#introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-metrics.html#setting-up-the-metrics-service">Setting Up</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-metrics.html#analysing-app-usage-metrics">App and Device</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-metrics.html#monitoring-idm-with-metrics">Monitoring IDM Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-metrics.html#monitoring-sync-with-metrics">Monitoring Data Sync Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-metrics.html#viewing-dashboards-metrics">Using Dashboards</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="mobile-cicd.html">Mobile CI/CD</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-cicd.html#introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-cicd.html#setup">Setting Up</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-cicd.html#build-config">Creating a Build Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-cicd.html#jenkins">Adding a Jenkins file</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-cicd.html#building">Building Apps</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-cicd.html#logs">Accessing Build Logs</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-cicd.html#deploy">Deploying Apps</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="mobile-cicd.html#clean">Cleaning up Builds</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="data-sync.html">Data Sync</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-getting-started.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-query.html">Queries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-mutation.html">Mutations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-offline.html">Offline</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-realtime.html">Realtime Updates</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-auth.html">Authz</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-metrics.html">Metrics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-conflict.html">Conflict Resolution</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-files.html">File Upload</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-audit.html">Audit Logs</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-advanced.html">Advanced Topics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ds-openshift.html">Running on OpenShift</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="security.html">Secure your app</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="security.html#app-security">Mobile Security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="security.html#app-setup">Setting Up</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="security.html#app-coding">Coding</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="security.html#console">Console</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="security.html">Device Checks</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="security.html#setting-up-the-device-security-service">Setting Up</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="security.html#performing-device-trust-checks_security">Performing Device Trust Checks</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="security.html#certificate-pinning_security">Certificate Pinning</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="showcase-apps.html">Showcase Apps</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="showcase-apps.html#setup">Service Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="showcase-apps.html#app">Showcase App Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="showcase-apps.html#binding">Service Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="showcase-apps.html#downloading-the-mobile-services-configuration-file">Downloading the Mobile Services Configuration File</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="showcase-apps.html#build">Building and Running the Showcase Apps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="showcase-apps.html#certs">Using Self Signed Certs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="showcase-apps.html#features">Demonstrating the Showcase App Features</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="supported_versions.html">Supported Versions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ref_api.html">API Reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="mobile-cli.html">Mobile CLI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Mobile Services</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Mobile Services</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">latest</a>
        </li>
        <li class="version">
          <a href="../v2.0/index.html">v2.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main" role="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="getting-started.html" class="home-link"></a>
<nav class="crumbs" role="navigation" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="con_services.html">Mobile Services</a></li>
    <li class="crumb"><a href="identity-management.html">Identity Management</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">latest</button>
  <div class="versions-menu">
    <a class="version is-current" href="identity-management.html">latest</a>
    <a class="version" href="../v2.0/identity-management.html">v2.0</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/aerogear/mobile-docs/edit/master/modules/ROOT/pages/identity-management.adoc"></a></div>
</div>
<article class="doc">
<h1>Using the Identity Management Mobile Service</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#reference-material-idm">Identity Management Service terminology</a></li>
<li><a href="#setting-up-the-idm-service">Setting Up the Identity Management Service</a>
<ul class="sectlevel2">
<li><a href="#provisioning-the-idm">Provisioning the Identity Management Service</a></li>
<li><a href="#binding-an-app-to-idm">Binding a Mobile App with the Identity Management Service</a></li>
<li><a href="#configuring-idm">Configuring the Identity Management Service</a></li>
</ul>
</li>
<li><a href="#configuring-your-development-environment-for-the-identity-management-service">Configuring your development environment for the Identity Management Service</a>
<ul class="sectlevel2">
<li><a href="#downloading-the-configuration-file-idm">Downloading the Configuration File</a></li>
<li><a href="#setting-up-sdk-idm">Setting up the Identity Management Service SDK</a></li>
</ul>
</li>
<li><a href="#adding-user-authentication-to-your-mobile-app">Adding User Authentication to your Mobile App</a>
<ul class="sectlevel2">
<li><a href="#implementing-authentication-idm">Implementing authentication</a></li>
<li><a href="#refreshing-the-authentication-token-idm">Refreshing the authentication token</a></li>
<li><a href="#adding-log-out-option-idm">Adding Log Out Option to your Mobile App</a></li>
<li><a href="#authenticating-with-a-back-end-service-idm">Authenticating with a back end service</a></li>
<li><a href="#adding-access-control-idm">Adding Access Control to your Mobile App</a></li>
</ul>
</li>
<li><a href="#adding-sso-to-your-mobile-app">Adding SSO to your Mobile App</a>
<ul class="sectlevel2">
<li><a href="#using-sso-idm">Using SSO with the Device Browser</a></li>
<li><a href="#monitoring-idm-with-idm">Monitoring the Identity Management Service</a>
<ul class="sectlevel4">
<li><a href="#dashboard-panel-descriptions">Dashboard panel descriptions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#additional-resources-2">Additional resources</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div id="introduction" class="paragraph">
<p>The Identity Management service allows you to add authentication and authorization to your mobile app.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Secure your mobile app using the industry standard OpenID Connect protocol</p>
</li>
<li>
<p>Add access control to your app based on user’s group membership</p>
</li>
<li>
<p>Easily implement SSO, multi-factor authentication and Social Login support</p>
</li>
<li>
<p>Back-end support for identity brokering and user federation</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reference-material-idm"><a class="anchor" href="#reference-material-idm"></a>Identity Management Service terminology</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes terminology that is associated with Identity Management.</p>
</div>
<div class="dlist">
<div class="title">Identity Management Terminology</div>
<dl>
<dt class="hdlist1">SSO</dt>
<dd>
<p>Single Sign On, the ability to share a login between multiple services</p>
</dd>
<dt class="hdlist1">OpenID Connect</dt>
<dd>
<p>A standard for providing identity on top of OAuth 2.0</p>
</dd>
<dt class="hdlist1">Keycloak</dt>
<dd>
<p>Red Hat’s implementation of SSO and OpenID used as the identity provider</p>
</dd>
<dt class="hdlist1">Client ID</dt>
<dd>
<p>Is the client identifier for OpenID Connect requests, a simple alpha-numeric string</p>
</dd>
<dt class="hdlist1">User Attributes</dt>
<dd>
<p>Additional properties for user accounts (besides name and email) managed by Keycloak</p>
</dd>
</dl>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have provisioned Mobile Developer Console as described in <a href="getting-started.html">Provisioning Mobile Developer Console</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-the-idm-service"><a class="anchor" href="#setting-up-the-idm-service"></a>Setting Up the Identity Management Service</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="provisioning-the-idm"><a class="anchor" href="#provisioning-the-idm"></a>Provisioning the Identity Management Service</h3>
<div class="paragraph">
<p>This section describes how to set up the IDM Mobile Service.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You understand identity management, and have a mobile app you want to protect.</p>
</li>
<li>
<p>You have logged into the OpenShift console and the Mobile Developer Console.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log into the OpenShift console.</p>
</li>
<li>
<p>Create a new project or choose an existing project.</p>
</li>
<li>
<p>Click <strong>Add to Project</strong> and choose <strong>Browse Catalog</strong> from the options.</p>
<div class="paragraph">
<p>You can filter the catalog items to only show mobile specific items by clicking the <strong>Mobile</strong> tab.</p>
</div>
</li>
<li>
<p>Click <strong>Services</strong> and choose the  service.</p>
<div class="imageblock">
<div class="content">
<img src="_images/catalog-mobile-services.png" alt="catalog mobile services">
</div>
</div>
</li>
<li>
<p>Follow the wizard for provisioning that service.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If prompted to <strong>Create a Binding</strong>, choose <strong>Do not bind at this time</strong>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When provisioning an Identity Management service, you are prompted to set the following configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Keycloak admin username</strong>: Username for Keycloak administration</p>
</li>
<li>
<p><strong>Keycloak admin password</strong>: Password for the Keycloak admin user</p>
</li>
<li>
<p><strong>Name of the Keycloak realm</strong>: Name of the Keycloak realm. (defaults to current namespace)</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A realm manages a set of users, credentials, roles, and groups. A user belongs to and logs into a realm. Realms are isolated from one another and can only manage and authenticate the users that they control.
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Connect to an existing shared service</strong>: Select if you want to use an existing service and you have the URL and credentials to use that service.</p>
</li>
<li>
<p><strong>URL of the shared service</strong>: Enter a value if you want to use an existing shared service.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the wizard steps are completed, navigate to the Project Overview in OpenShift to see the newly provisioned service.
Provisioning a service may take some time.</p>
</div>
</div>
<div class="sect2">
<h3 id="binding-an-app-to-idm"><a class="anchor" href="#binding-an-app-to-idm"></a>Binding a Mobile App with the Identity Management Service</h3>
<div class="paragraph">
<p>To use mobile services, you must represent your mobile app in <strong>Mobile Developer Console</strong>, and that app must be associated with the mobile service.
This association is called <strong>binding</strong> and it is necessary for your mobile app to use that service.</p>
</div>
<div class="paragraph">
<p>This section describes how to set up the Identity Management service.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have created a Mobile App.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To bind a Mobile App with a mobile service:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Launch Mobile Developer Console.</p>
</li>
<li>
<p>Click on the Mobile App on the Overview screen.</p>
</li>
<li>
<p>Navigate to <strong>Mobile Services</strong> tab.</p>
<div class="imageblock">
<div class="content">
<img src="_images/mobile-clients-services-all-unbound.png" alt="mobile clients services all unbound">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is possible to bind a Mobile App with a mobile service in the OpenShift console, however such bindings are not valid for the purposes of this procedure.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <strong>Bind to App</strong> for .</p>
</li>
<li>
<p>Fill out the binding parameters required by the  Service.</p>
<div class="imageblock">
<div class="content">
<img src="_images/mobile-clients-services-idm-parameters.png" alt="mobile clients services idm parameters">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Use <code>Public</code> when binding a Mobile App to a . When binding mobile services to each other, use <code>Bearer</code>.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The  service will now be expandable, details about the service can be viewed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/mobile-clients-services-all-idm-provisioned.png" alt="mobile clients services all idm provisioned">
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring-idm"><a class="anchor" href="#configuring-idm"></a>Configuring the Identity Management Service</h3>
<div class="paragraph">
<p>This section guides you through configuring the redirect url and web origin for a client in Keycloak.
This is required to enable OpenID authentication.
For an explanation of these terms, see <a href="https://www.keycloak.org/documentation.html">Keycloak Documentation</a>.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An understanding of <a href="https://openid.net/" target="_blank" rel="noopener">OpenID</a></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log into the Mobile Developer Console and navigate to the Mobile App screen.</p>
</li>
<li>
<p>Select the <strong>Mobile Services</strong> tab.</p>
</li>
<li>
<p>If a binding to the Identity Management service is in progress, a spinning icon is displayed to the right of the Identity Management entry. Wait for the binding process to complete.</p>
</li>
<li>
<p>If the <em>Keycloak Realm URL</em> URL is not visible, expand the Identity Management Service by clicking the &gt; icon.</p>
</li>
<li>
<p>Click on the <strong>Keycloak Realm URL</strong> link to open the Keycloak Administration Console.</p>
</li>
<li>
<p>Log in to the Administration console using the credentials you specified when <a href="#provisioning-the-keycloak-service">Provisioning</a> the service (defaults to admin/admin).</p>
</li>
<li>
<p>Select <code>Clients</code> from the left navigation menu.</p>
</li>
<li>
<p>Select your client from the list of clients. The name of your client is derived from the name of the Mobile App, the name of the mobile development platform and the client type, for example <code>myapp-android-public</code>.</p>
</li>
<li>
<p>Add an additional entry to <strong>Valid Redirect URIs</strong>.</p>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset1_android"></a>Android</p>
</li>
<li>
<p><a id="tabset1_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset1_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset1_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset1_android">
<div class="paragraph">
<p>It is recommended to use the package name of the Android app as the schema of the redirect url to avoid conflicts. (e.g. <code>com.aerogear.androidshowcase</code>)</p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_ios">
<div class="paragraph">
<p>It is recommended to use the Bundle Identifier of the iOS app as the schema of the redirect url. (e.g. <code>org.aerogear.ios-showcase-template</code>)</p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_cordova">
<div class="paragraph">
<p>Set the additional value to <code><a href="http://localhost*" class="bare">http://localhost*</a></code>.</p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_xamarin">
<div class="paragraph">
<p>Depending on the platform, set the redirect URL as described in either the Android or the iOS tab.</p>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Add an additional entry to <strong>Web Origins</strong>.</p>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset2_android"></a>Android</p>
</li>
<li>
<p><a id="tabset2_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset2_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset2_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset2_android">
<div class="paragraph">
<p>Use the package name of the Android app to avoid conflicts. (e.g. <code>com.aerogear.androidshowcase</code>)</p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset2_ios">
<div class="paragraph">
<p>Use the Bundle Identifier of the iOS app. (e.g. <code>org.aerogear.ios-showcase-template</code>)</p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset2_cordova">
<div class="paragraph">
<p>Set additional value to <code><a href="http://localhost*" class="bare">http://localhost*</a></code>.</p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset2_xamarin">
<div class="paragraph">
<p>Depending on the target platform, set the additional value as described in either the Android or the iOS tab.</p>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Save your changes.</p>
</li>
<li>
<p>Creating a new user account as described in <a href="https://www.keycloak.org/docs/3.3/server_admin/topics/users/create-user.html">Creating a New User</a>.</p>
</li>
<li>
<p>Set up credentials for the new user as described in <a href="https://www.keycloak.org/docs/3.3/server_admin/topics/users/credentials.html">User Credentials</a>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-your-development-environment-for-the-identity-management-service"><a class="anchor" href="#configuring-your-development-environment-for-the-identity-management-service"></a>Configuring your development environment for the Identity Management Service</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="downloading-the-configuration-file-idm"><a class="anchor" href="#downloading-the-configuration-file-idm"></a>Downloading the Configuration File</h3>
<div class="paragraph">
<p>The <code>mobile-services.json</code> file provides the information for your mobile app to communicate with services.
After you change any configuration in the Mobile Developer Console, it is important to update that file in your IDE.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The configuration of your Mobile App in Mobile Developer Console is up-to-date.</p>
</li>
<li>
<p>You have set up your mobile app development environment.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Open your Mobile App in Mobile Developer Console.</p>
</li>
<li>
<p>Copy the <code>mobile-services.json</code> configuration to your clipboard.</p>
</li>
<li>
<p>Save the contents of the clipboard to a new file called <code>mobile-services.json</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>mobile-services.json</code> file is the link between your provisioned services on OpenShift and the mobile app you are developing. This file provides all required configuration to initialise the various SDKs and get them hooked up/connected to the back-end services.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Move mobile-services.json to the following location in your application project:</p>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset3_android"></a>Android</p>
</li>
<li>
<p><a id="tabset3_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset3_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset3_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset3_android">
<div class="paragraph">
<p><code>app/src/main/assets/mobile-services.json</code></p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset3_ios">
<div class="paragraph">
<p><code>&lt;app directory&gt;/mobile-services.json</code>
NOTE: Ensure that <code>mobile-services.json</code> is a member of the project in the Xcode Project Navigator.</p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset3_cordova">
<div class="paragraph">
<p><code>src/mobile-services.json</code></p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset3_xamarin">
<div class="paragraph">
<p><code>Resources/mobile-services.json</code></p>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="setting-up-sdk-idm"><a class="anchor" href="#setting-up-sdk-idm"></a>Setting up the Identity Management Service SDK</h3>
<div class="paragraph">
<p>This section helps you to set up the Identity Management service SDK in your App.
It describes how to set up and initialize the Identity Management service SDK.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Your local <code>mobile-services.json</code> file is up-to-date.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Import the libraries.</p>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset4_android"></a>Android</p>
</li>
<li>
<p><a id="tabset4_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset4_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset4_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset4_android">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the following dependency in your app&#8217;s <strong>build.gradle</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
    implementation "org.aerogear:android-auth:1.0.0"
}</code></pre>
</div>
</div>
</li>
<li>
<p>To prevent build errors, add the following in your app&#8217;s <strong>build.gradle</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">compileOptions {
    sourceCompatibility 1.8
    targetCompatibility 1.8
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset4_ios">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the dependency to your <strong>Podfile</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">target '[TARGET NAME]' do
    pod 'AGSAuth', '1.0.0'
end</code></pre>
</div>
</div>
</li>
<li>
<p>Update the dependencies:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ pod install</code></pre>
</div>
</div>
</li>
<li>
<p>Import and instantiate <code>AGSAuth</code> to start using the SDK:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">import AGSAuth

auth = AGSAuth()</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset4_cordova">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the following code to <code>index.html</code> located in <code>src/</code> :</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;meta http-equiv="Content-Security-Policy" content="default-src * file: 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;"&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Install the <a href="https://www.npmjs.com/package/@aerogear/auth">AeroGear Auth</a> package from <a href="https://www.npmjs.com/" target="_blank" rel="noopener">NPM</a>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install @aerogear/auth</code></pre>
</div>
</div>
</li>
<li>
<p>Install cordova-plugin-inappbrowser:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ cordova plugin add cordova-plugin-inappbrowser</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use a JavaScript bundler, for example, <code>browserify</code> so that you can use node modules in Cordova. AeroGear recommends using the <code>require</code> statement rather than <code>import</code> for the the @aerogear/auth module as shown below:</p>
</div>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset4_xamarin">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install <a href="https://docs.microsoft.com/en-us/nuget/install-nuget-client-tools" target="_blank" rel="noopener">NuGet</a>.</p>
</li>
<li>
<p>Install the <a href="https://www.nuget.org/packages/AeroGear.Mobile.Core" target="_blank" rel="noopener">AeroGear Core</a> package:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">dotnet add package AeroGear.Mobile.Core --version 1.0.0</code></pre>
</div>
</div>
</li>
<li>
<p>For Android run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">dotnet add package AeroGear.Mobile.Core.Platform.Android --version 1.0.0
dotnet add package AeroGear.Mobile.Auth.Platform.Android --version 1.0.0</code></pre>
</div>
</div>
</li>
<li>
<p>For iOS run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">dotnet add package AeroGear.Mobile.Core.Platform.iOS --version 1.0.0
dotnet add package AeroGear.Mobile.Auth.Platform.iOS --version 1.0.0</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Initialize the SDK.</p>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset5_android"></a>Android</p>
</li>
<li>
<p><a id="tabset5_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset5_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset5_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset5_android">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Specify the redirect URL. It is recommended to use the package name of your app.</p>
<div class="listingblock">
<div class="content">
<pre>AuthServiceConfiguration authServiceConfig = new AuthServiceConfiguration
    .AuthConfigurationBuilder()
    .withRedirectUri("org.aerogear.mobile.example:/callback")
    .build();</pre>
</div>
</div>
</li>
<li>
<p>Create the auth service:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">AuthService authService = new AuthService(authServiceConfig);</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset5_ios">
<div class="paragraph">
<p>Set your custom configuration to the auth service instance, making sure the redirect URL matches the App&#8217;s Bundle Id.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">// create the authentication config
let authenticationConfig = AuthenticationConfig(redirectURL: "org.aerogear.mobile.example:/callback")
try! AgsAuth.instance.configure(authConfig: authenticationConfig, useExternalUserAgent: false)</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset5_cordova">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Import and initialize Auth.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const Auth = require('@aerogear/auth').Auth;
const authService = new Auth(app.config);
const initOptions = { onLoad: "login-required" };

authService.init(initOptions)
    .then(() =&gt; {
        // successful init &amp; authentication
    })
    .catch((err) =&gt; {
        // initialization error
    });</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can pass <code>login-required</code> or <code>check-sso</code> to the init function. <code>login-required</code> will authenticate the client if the user is logged in to Keycloak or display the login page if not. <code>check-sso</code> will only authenticate the client if the user is already logged in. If the user is not logged in the browser will be redirected back to the application and remain unauthenticated. By default, the <code>check-sso</code> option is used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Initialization also enables authentication.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To use self-signed certificates with your Cordova application, complete the following instructions <a href="showcase-apps.html#certs">here</a>.</p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset5_xamarin">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an <a href="https://developer.android.com/guide/topics/manifest/manifest-intro#ifs" target="_blank" rel="noopener">intent filter</a> for the <code>net.openid.appauth.RedirectUriReceiverActivity</code> activity. This step is required for Xamarin Android and allows the login browser to redirect back to your App. Add this to your <code>AndroidManifest.xml</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;activity android:name="net.openid.appauth.RedirectUriReceiverActivity" android:exported="true"  android:icon="@mipmap/ic_launcher" android:roundIcon="@mipmap/ic_launcher_round"&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="android.intent.action.VIEW" /&gt;
        &lt;category android:name="android.intent.category.DEFAULT" /&gt;
        &lt;category android:name="android.intent.category.BROWSABLE" /&gt;
        &lt;data android:scheme="org.aerogear.mobile.example" /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Initialize the Auth module</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For an Android app (MainActivity.cs):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">var app = new App();
MobileCoreAndroid.Init(app.GetType().Assembly,ApplicationContext);
var authService = AuthService.InitializeService();
var authConfig = AuthenticationConfig.Builder.RedirectUri("org.aerogear.mobile.example:/callback").Build();
authService.Configure(authConfig);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For Android an <a href="https://developer.android.com/guide/topics/manifest/manifest-intro#ifs" target="_blank" rel="noopener">Intent filter</a> should be configured with the callback URL specified in AuthenticateOptions in the App&#8217;s AndroidManifest.xml. See the <a href="https://github.com/aerogear/xamarin-showcase-template/blob/master/Example.Android/Properties/AndroidManifest.xml" target="_blank" rel="noopener">example app</a>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>For an iOS app (FinishedLaunching method of AppDelegate.cs):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">var app = new App();
MobileCore core = MobileCoreIOS.Init(app.GetType().Assembly);
var authService = AuthService.InitializeService();
var authConfig = AuthenticationConfig.Builder.RedirectUri("org.aerogear.mobile.example:/callback").Build();
authService.Configure(authConfig);</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-user-authentication-to-your-mobile-app"><a class="anchor" href="#adding-user-authentication-to-your-mobile-app"></a>Adding User Authentication to your Mobile App</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="implementing-authentication-idm"><a class="anchor" href="#implementing-authentication-idm"></a>Implementing authentication</h3>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>mobile-services.json</code> file is up-to-date in your development environment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To implement authentication using the Aerogear SDK:</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset6_android"></a>Android</p>
</li>
<li>
<p><a id="tabset6_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset6_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset6_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset6_android">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Provide an implementation of <code>Callback</code> which is defined in the Aerogear SDK and used to handle asynchronous results:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Callback authCallback = new Callback&lt;UserPrincipal&gt;() {
    @Override
    public void onSuccess(UserPrincipal principal) {
        ...
    }

    @Override
    public void onError(Throwable error) {
        ...
    }
};</code></pre>
</div>
</div>
</li>
<li>
<p>Use the <code>login</code> method to hand over to the login browser:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Build the options object and start the authentication flow
DefaultAuthenticateOptions options = new DefaultAuthenticateOptions(myActivity, LOGIN_RESULT_CODE);

authService.login(options, authCallback);</code></pre>
</div>
</div>
</li>
<li>
<p>Override <code>onActivityResult</code> to handle the result from the browser. It&#8217;s important to pass the intent back to the Auth service:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == LOGIN_RESULT_CODE) {
        authService.handleAuthResult(data);
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This handler should always invoke <code>handleAuthResult</code>, providing the <code>Intent</code>. This will exchange the temporary tokens returned from <code>login</code> for long-lived tokens and will provide a <code>UserPrincipal</code> which can be used to access a users details. If this is not invoked you will not have access to the <code>UserPrincipal</code>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>The callback provided to <code>login</code> will be invoked.</p>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset6_ios">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the <code>login</code> method to hand over to the login browser:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">AgsAuth.instance.login(presentingViewController: self, onCompleted: onLoginComplete)

func onLoginComplete(user: User?, err: Error?) {
    if let error = err {
        return
    }

    let currentUser = user
}</code></pre>
</div>
</div>
</li>
<li>
<p>Allow your application to handle the redirect in <code>AppDelegate</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">func application(_ app: UIApplication, open url: URL, options: [UIApplicationOpenURLOptionsKey: Any] = [:]) -&gt; Bool {
    do {
        return try AgsAuth.instance.resumeAuth(url: url as URL)
    } catch AgsAuth.Errors.serviceNotConfigured {
        print("AeroGear auth service is not configured")
    } catch {
        fatalError("Unexpected error: \(error).")
    }
    return false
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset6_cordova">
<div class="paragraph">
<p>Authentication is enabled during initialization as described in the section <a href="#setting-up-sdk-idm">Setting up the Identity Management Service SDK</a>. To manually redirect to the login screen, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">authService.login().then(() =&gt; {
    // Login success
}).catch(() =&gt; {
    // Login error
});;</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset6_xamarin">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the <code>Authenticate</code> method to hand over to the login browser:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">IAuthService authService = MobileCore.Instance.GetService&lt;IAuthService&gt;();

var authOptions = DependencyService.Get&lt;IAuthenticateOptionsProvider&gt;().GetOptions();
var user = await authService.Authenticate(authOptions);</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="refreshing-the-authentication-token-idm"><a class="anchor" href="#refreshing-the-authentication-token-idm"></a>Refreshing the authentication token</h3>
<div class="paragraph">
<p>When a user is authenticated, an access token and a refresh token are generated by the authentication server.
See the <a href="https://access.redhat.com/documentation/en-us/red_hat_single_sign-on/7.2/html-single/server_administration_guide/#timeouts">Keycloak documentation</a> for information about configuring the lifespan of these tokens.
If the refresh token is still valid, the authentication token can be refreshed even if the authentication token has expired.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A working mobile app that uses authentication with the Identity Management service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To automatically refresh the authenticate token :</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset7_android"></a>Android</p>
</li>
<li>
<p><a id="tabset7_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset7_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset7_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset7_android">
<div class="paragraph">
<p>Retrieve the current user and refresh the access token when possible and required:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">UserPrincipal currentUser = authService.currentUser(true);</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset7_ios">
<div class="paragraph">
<p>Retrieve the current user and refresh the access token when possible and required:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">do {
    try AgsAuth.instance.currentUser(autoRefresh: true) { (currentUser, error) in
        // If error is nil, currentUser is now refreshed
    }
} catch {
    // An error has occurred trying to reach the authentication server
}</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset7_cordova">
<div class="paragraph">
<p>Retrieve the keycloak adapter object and refresh the access token, when possible and required:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">authService.extract().updateToken(30).then(() =&gt; {
    // Token has been refreshed
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>More information about the keycloak javascript adapter can be found <a href="https://www.keycloak.org/docs/3.0/securing_apps/topics/oidc/javascript-adapter.html">here</a></p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset7_xamarin">
<div class="paragraph">
<p>Retrieve the current user and refresh, if needed and still possible, its access token:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">var authService = MobileCore.Instance.GetService&lt;IAuthService&gt;();
var currentUser = await authService.CurrentUser(true);</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-log-out-option-idm"><a class="anchor" href="#adding-log-out-option-idm"></a>Adding Log Out Option to your Mobile App</h3>
<div class="paragraph">
<p>The following section describes how to perform a logout.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To perform <strong>backchannel or federated logouts</strong>, you must enable the Backchannel Logout option for the federated identity provider.
More information is available in the Keycloak documentation under <a href="https://www.keycloak.org/docs/3.3/server_admin/topics/identity-broker/oidc.html" target="_blank" rel="noopener">OICD Identity Providers</a>.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A working mobile app that uses authentication with the Identity Management service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To enable users of the mobile app log out from the service.</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset8_android"></a>Android</p>
</li>
<li>
<p><a id="tabset8_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset8_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset8_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset8_android">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Retrieve the current user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">UserPrincipal currentUser = authService.currentUser();</code></pre>
</div>
</div>
</li>
<li>
<p>Implement <code>Callback</code> and call <code>logout</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>authService.logout(currentUser, new Callback&lt;UserPrincipal&gt;() {
    @Override
    public void onSuccess() {
        // User Logged Out Successfully and local Auth tokens were Deleted
    }

    @Override
    public void onError(Throwable error) {
        // An error occurred during logout
    }
});</pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset8_ios">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implement the logout callback:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">func onLogoutComplete(_: Error?) {
    // User Logged Out Successfully and local Auth tokens were Deleted
    ...
}</code></pre>
</div>
</div>
</li>
<li>
<p>Call <code>logout</code> and pass the callback:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">do {
    try AgsAuth.instance.logout(onCompleted: self.onLogoutComplete)
} catch {
    fatalError("Error logging out: \(error).")
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset8_cordova">
<div class="paragraph">
<p>Invoke the <code>logout</code> function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">authService.logout().then(() =&gt; {
    // User Logged Out Successfully and local Auth tokens were Deleted
});</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset8_xamarin">
<div class="paragraph">
<p>To logout invoke the <code>Logout</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">var authService = MobileCore.Instance.GetService&lt;IAuthService&gt;();
var result = await authService.Logout(authService.CurrentUser());</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="authenticating-with-a-back-end-service-idm"><a class="anchor" href="#authenticating-with-a-back-end-service-idm"></a>Authenticating with a back end service</h3>
<div class="paragraph">
<p>In a typical scenario, you not only want the user to authenticate on the mobile app, you also want that user to authenticate with a back end service.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A working mobile app that uses authentication with the Identity Management service.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add an additional token:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Authorization: BEARER Yourtoken</code></pre>
</div>
</div>
</li>
<li>
<p>Add code to authenticate with a back end service:</p>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset9_android"></a>Android</p>
</li>
<li>
<p><a id="tabset9_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset9_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset9_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset9_android">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the <code>AuthHeaderProvider</code> instance provided by the Aerogear SDK:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">authService.getAuthHeaderProvider()</code></pre>
</div>
</div>
</li>
<li>
<p>Plug it into your networking layer. When using the <code>okhttp</code> library, this can be added to the list of request interceptors to automatically supply the required tokens:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">MobileCore.getInstance()
          .getHttpLayer()
          .requestHeaderInterceptor()
          .add(authService.getAuthHeaderProvider());</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset9_ios">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the <code>AuthHeaderProvider</code> instance provided by the Aerogear SDK:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">authService.getAuthHeaderProvider()</code></pre>
</div>
</div>
</li>
<li>
<p>Plug it into your networking layer.</p>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset9_cordova">
<div class="paragraph">
<p>The AeroGear Cordova SDK doesn&#8217;t provide an HTTP layer, therefore it cannot provide an Auth Header Provider.
You must manually attach the <code>Bearer</code> header to your HTTP requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">req.setRequestHeader('Accept', 'application/json');
req.setRequestHeader('Authorization', 'Bearer ' + authService.extract().token);</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset9_xamarin">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the <code>AuthHeaderProvider</code> instance provided by the Aerogear SDK:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">var authHeaderProvider = authService.AuthHeaderProvider;</code></pre>
</div>
</div>
</li>
<li>
<p>Plug it into your networking layer.----</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#android-additional-configuration">Additional configuration for Android</a></p>
</li>
<li>
<p><a href="https://www.keycloak.org/docs/3.3/server_admin/topics/identity-broker/oidc.html" target="_blank" rel="noopener">Keycloak OICD Providers</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="adding-access-control-idm"><a class="anchor" href="#adding-access-control-idm"></a>Adding Access Control to your Mobile App</h3>
<div class="paragraph">
<p>Once a <code>UserPrincipal</code> has been retrieved, the <a href="http://www.keycloak.org/docs/latest/server_admin/index.html#roles" target="_blank" rel="noopener">roles</a> of the user can be listed and checked.
This can be used to perform client side access control, such as hiding UI components related to actions the user doesn&#8217;t have permissions to perform.
Roles are divided into two types. Resource roles which belong to the client the user has authenticated against, and Realm roles which belong to the realm the client is in.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>A working mobile app that uses authentication with the Identity Management service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To add Access Control:</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset10_android"></a>Android</p>
</li>
<li>
<p><a id="tabset10_ios"></a>iOS</p>
</li>
<li>
<p><a id="tabset10_cordova"></a>Cordova</p>
</li>
<li>
<p><a id="tabset10_xamarin"></a>Xamarin</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset10_android">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Retrieve the authenticated user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">UserPrincipal currentUser = authService.currentUser();</code></pre>
</div>
</div>
</li>
<li>
<p>Use <code>hasRealmRole</code> and <code>hasResourceRole</code> to check for roles:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">boolean hasAdminPermissions = currentUser.hasRealmRole("user_admin");
boolean isModerator = currentUser.hasResourceRole("my_resource", "user_moderator");</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset10_ios">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Retrieve the authenticated user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">let currentUser = try AgsAuth.instance.currentUser()</code></pre>
</div>
</div>
</li>
<li>
<p>The user roles are available on the authenticated user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">let clientRoles = currentUser.clientRoles
let realmRoles = currentUser.realmRoles</code></pre>
</div>
</div>
</li>
<li>
<p>Use <code>hasRealmRole</code> and <code>hasClientRole</code> to check for roles:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">let hasAdminRole = currentUser.hasRealmRole("admin")
let hasModeratorRole = currentUser.hasClientRole(client: "my_client", role: "moderator")</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset10_cordova">
<div class="paragraph">
<p>Get the realm roles from the auth service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const realmRoles = authService.getRealmRoles();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
No function to retrieve the resource roles is currently exported but you can use <code>extract</code> to get a handle to the underlying keycloak-js instance to retrieve the roles from there. Have a look at their documentation <a href="https://www.keycloak.org/docs/latest/securing_apps/index.html#_javascript_adapter" target="_blank" rel="noopener">here</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset10_xamarin">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Retrieve the authenticated user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">// auth service is already initialised
var user = MobileCore.Instance.GetService&lt;IAuthService&gt;().CurrentUser();</code></pre>
</div>
</div>
</li>
<li>
<p>Use <code>getRoles</code> to retrieve all roles from the user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">// auth service is already initialised
var roles = user.getRoles();</code></pre>
</div>
</div>
</li>
<li>
<p>Use <code>HasRealmRole</code> and <code>HasResourceRole</code> to check for roles:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">bool isAdmin = user.HasRealmRole("user_admin");
bool isModerator = user.HasResourceRole("my_resource", "user_moderator");</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-sso-to-your-mobile-app"><a class="anchor" href="#adding-sso-to-your-mobile-app"></a>Adding SSO to your Mobile App</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="using-sso-idm"><a class="anchor" href="#using-sso-idm"></a>Using SSO with the Device Browser</h3>
<div class="paragraph">
<p>The AeroGear mobile SDK uses OpenID Connect <a href="http://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth">Authorization Code Flow</a> to implement SSO using a mobile device browser.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You have completed all steps in <a href="#adding-access-control-keycloak-service">Adding Access Control to your Mobile App</a>.</p>
</li>
<li>
<p>Two Mobile Apps bound to the Identity Management service.</p>
</li>
<li>
<p>Two Mobile Apps built and running on the same device that are using the AeroGear SDK Auth module.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>In the following procedure, the two apps are named <strong>Email App</strong> and <strong>Messaging App</strong>.
Substitute the appropriate names for your SSO scenario.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure the "Remember Me" option in Keycloak is turned on. In the admin UI click on <strong>Realm Settings</strong> section on the left hand side, and then click on <strong>Login</strong>. Turn on <strong>Remember Me</strong>.</p>
</li>
<li>
<p>Now that your two apps and Keycloak clients are setup, sign into the <strong>Email App</strong> with the user you have previously created. You should be redirected to your device browser which should have loaded the Keycloak login page.</p>
</li>
<li>
<p>Next, enter in your credentials, make sure check the <strong>Remember Me</strong> option and login. You have now been authenticated on the <strong>Email App</strong> via the browser.</p>
</li>
<li>
<p>Finally, try sign into the <strong>Messaging App</strong> and you should be automatically logged in as you have been previously authenticated in the <strong>Email App</strong> via the <strong><em>same</em></strong> browser.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Additional resources</div>
<p>With iOS 11 and later, Apple has introduced SFAuthenticationSession for apps to perform SSO, instead of using the system Safari browser and there are known issues with this new feature.
Sometimes, the user may have to enter their credentials again, even if they have logged in previously in another app.</p>
</div>
</div>
<div class="sect2">
<h3 id="monitoring-idm-with-idm"><a class="anchor" href="#monitoring-idm-with-idm"></a>Monitoring the Identity Management Service</h3>
<div class="paragraph">
<p>After the Mobile Metrics Service (includes Grafana for visualization and the Prometheus monitoring system) and Identity Management Service are provisioned,
you should be able to see the "Keycloak Metrics" in the list of available dashboards.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Mobile Metrics Service and Identity Management Service must be provisioned in the same OpenShift project to access data.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Navigate to Grafana.</p>
</li>
<li>
<p>Select <strong>Keycloak Metrics</strong>.</p>
</li>
</ol>
</div>
<h4 id="additional-resources" class="discrete">Additional resources</h4>
<div class="ulist">
<ul>
<li>
<p><a href="http://docs.grafana.org/features/panels/singlestat/#singlestat-panel" target="_blank" rel="noopener">Singlestat Panel</a></p>
</li>
<li>
<p><a href="http://docs.grafana.org/features/panels/graph/#graph-panel" target="_blank" rel="noopener">Graph Panel</a></p>
</li>
<li>
<p><a href="https://grafana.com/plugins/grafana-piechart-panel" target="_blank" rel="noopener">Pie Chart</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="dashboard-panel-descriptions"><a class="anchor" href="#dashboard-panel-descriptions"></a>Dashboard panel descriptions</h5>
<div class="paragraph">
<p>The Keycloak dashboard consists of several panels which give you an overview of the specific
events, such as the number of registered users, memory usage etc.</p>
</div>
<div class="paragraph">
<p>Below you will find a detailed description of each panel and its values.</p>
</div>
<div class="paragraph">
<div class="title">Singlestat Panels</div>
<p>Singlestat panels show you the main summary of a single data series.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Total Registrations</strong>: Total number of registered (non-admin) users. This number comprises all successful registrations made via various providers, e.g. Keycloak, Github, Facebook etc.</p>
</li>
<li>
<p><strong>Total Logins</strong>: Total number of successful logins (only non-admin users) over all providers.</p>
</li>
<li>
<p><strong>Total Login Errors</strong>: Total number of failed login attempts.</p>
</li>
<li>
<p><strong>Current Memory</strong>: The amount of memory currently used by the Identity Management Service</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Graph panels</div>
<p>Used to show how certain values change over time, e.g. the number of successful logins.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Logins</strong>: Overview of the successful logins over time</p>
</li>
<li>
<p><strong>Login Errors</strong>: Overview of the failed login attempts over time</p>
</li>
<li>
<p><strong>Memory Usage</strong>: The values in this graph represents the following:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Used</strong>: The amount of memory currently used by the Identity Management Service</p>
</li>
<li>
<p><strong>Commited</strong>: The amount of memory that is guaranteed to be available for use (by JVM)</p>
</li>
<li>
<p><strong>Max</strong>: The maximum amount of memory that can be used for memory management</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Pie Charts</div>
<p>Used to show the distribution of data, e.g. the number of logins per identity provider.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Logins Per Provider</strong>: Overview of the successful (non-admin) user logins per provider</p>
</li>
<li>
<p><strong>Registrations Per Provider</strong>: Overview of the successful (non-admin) user registrations per provider.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="additional-resources-2"><a class="anchor" href="#additional-resources-2"></a>Additional resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>For more information about OpenID, see the <a href="https://openid.net/" target="_blank" rel="noopener">OpenID Foundation</a> website.</p>
</li>
<li>
<p>See the <a href="https://www.keycloak.org/documentation.html" target="_blank" rel="noopener">Keycloak documentation</a> for more info.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <div class="container">
    <div class="row">

      <div class="col-sm-4">
        <h5>Mobile Services</h5>
        <ul class="list-unstyled">
         <li><a href="https://aerogear.org/services/identity-management/">Identity Management</a></li>
         <li><a href="https://aerogear.org/services/push/">Push Notifications</a></li>
         <li><a href="https://aerogear.org/services/metrics/">Mobile Metrics</a></li>
         <li><a href="https://aerogear.org/services/mobile-ci-cd/">Mobile CI/CD</a></li>
         <li><a href="https://aerogear.org/services/device-security/">Device Security</a></li>
        </ul>
      </div><!-- col -->

      <div class="col-sm-4">
        <h5>Mobile SDKs</h5>
        <ul class="list-unstyled">
         <li><a href="https://aerogear.org/sdks/android/">Android</a></li>
         <li><a href="https://aerogear.org/sdks/cordova/">Cordova</li>
         <li><a href="https://aerogear.org/sdks/ios/">iOS</a></li>
         <li><a href="https://aerogear.org/sdks/xamarin/">Xamarin</a></li>
        </ul>
      </div><!-- col -->
      
      <div class="col-sm-4">
        <h5>COMMUNITY</h5>
        <ul class="list-unstyled">
          <li><a target="_blank" href="https://github.com/aerogear/">GitHub - Aerogear</a></li>
          <li><a target="_blank" href="https://github.com/aerogearcatalog/">GitHub - Aerogear Catalog</a></li>
          <li><a target="_blank" href="https://issues.jboss.org/browse/AEROGEAR">Jira Repo Issues</a></li>
          <li><a  href="https://aerogear.org/community/contribution-guide/">Contribution Guide</a></li>
          <li><a target="_blank" href="https://groups.google.com/forum/#!forum/aerogear">Google Group</a></li>
          <li><a href="irc://irc.freenode.net/aerogear">IRC</a></li>
        </ul>
      </div><!-- col -->

      <div class="col-sm-12 follow">
        <h5>FOLLOW US</h5>
        <ul class="list-inline">
          <li><a target="_blank" href="https://www.twitter.com/aerogears"><i class="fa fa-twitter-square"></i> Twitter</a></li>
          <li><a target="_blank" href="https://www.youtube.com/channel/UCgDcDoN2b7cEI63fgpxACBA"><i class="fa fa-youtube"></i> YouTube</a></li>
          <li><a target="_blank" href="https://aerogear.org/news"><i class="fa fa-rss-square"></i> Feed</a></li>
        </ul>
        
        <p>The AeroGear project is licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>, and is subject to the <a href="https://aerogear.org/legal/export.html">Export Policy</a>.</p>
      </div><!-- col -->
    
    </div><!-- row -->

  </div><!-- container -->

</footer><!-- footer -->

<section class="redhat">
  <div class="container">
    <p class="text-center">
      <a href="http://www.redhat.com/">
        <img src="/_/img/redhatlogo-wite.png" alt="redhatlogo-wite" width="130">
      </a>
    </p>       
  </div><!-- container -->
</section>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
