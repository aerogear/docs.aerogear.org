<!DOCTYPE html>
<html lang="en">
  <head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
<script>
function addBlockSwitches() {
	$('.primary').each(function() {
		primary = $(this);
		createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
		primary.children('.title').remove();
	});
	$('.secondary').each(function(idx, node) {
		secondary = $(node);
		primary = findPrimary(secondary);
		switchItem = createSwitchItem(secondary, primary.children('.switch'));
		switchItem.content.addClass('hidden');
		findPrimary(secondary).append(switchItem.content);
		secondary.remove();
	});
}

function createBlockSwitch(primary) {
	blockSwitch = $('<div class="switch"></div>');
	primary.prepend(blockSwitch);
	return blockSwitch;
}

function findPrimary(secondary) {
	candidate = secondary.prev();
	while (!candidate.is('.primary')) {
		candidate = candidate.prev();
	}
	return candidate;
}

function createSwitchItem(block, blockSwitch) {
	blockName = block.children('.title').text();
	content = block.children('.content').first().append(block.next('.colist'));
	item = $('<div class="switch--item">' + blockName + '</div>');
	item.on('click', '', content, function(e) {
		$(this).addClass('selected');
		$(this).siblings().removeClass('selected');
		e.data.siblings('.content').addClass('hidden');
		e.data.removeClass('hidden');
	});
	blockSwitch.append(item);
	return {'item': item, 'content': content};
}

$(addBlockSwitches);    
</script>


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled :: AeroGear Mobile Services</title>
    <link rel="canonical" href="https://www.aerogear.org/aerogear/latest/push/ref_message-format.html">
    <meta name="generator" content="Antora 1.0.0">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.aerogear.org">AeroGear Mobile Services</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">

    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="aerogear" data-version="latest">
  <aside class="navigation" role="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">AeroGear Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../index.html">Getting Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../registering-a-mobile-app.html">Registering a Mobile App</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuring-dev-env.html">Dev Environment Setup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../con_services.html">Mobile Services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../keycloak/index.html">Identity Management</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/binding.html">Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/coding.html">Coding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/authenticating.html">User Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/retrieving-users-roles.html">Access Control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../keycloak/sso.html">Single Sign On</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/monitoring-keycloak.html">Monitoring Identity Management</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../security/index.html">Device Security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../security/proc_performing-device-checks.html">Device Trust Checks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../security/proc_pinning-certificates.html">Certificate Pinning</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="index.html">Push Notifications</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="binding.html">Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="coding.html">Coding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">More&#8230;&#8203;</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="proc_sending-a-push-notification.html">Sending a Push Notification</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="admin-ui.html">Unified Push Admin UI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="handling-push-notifications.html">Handling Push Notifications</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="proc_preparing-ups-for-use-with-ios.html">Apple Push Network</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="google-setup.html">Firebase Cloud Messaging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../metrics/index.html">Mobile Metrics</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/binding.html">Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/configuring-dev-env-metrics.html">Coding an App to use Mobile Metrics</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../metrics/analysing-app-usage.html">Analysing Apps and Devices</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../custom/index.html">Runtime Connector</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../custom/provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../custom/binding.html">Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../custom/configuring-dev-env-custom.html">Using Runtime Connectors in an App</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../digger/index.html">Mobile CI/CD</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../digger/provisioning.html">Provisioning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../digger/creating-a-build-configuration.html">Creating a Build Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../digger/running-a-build.html">Building Apps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../digger/deploy-the-app.html">Deploying Apps</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../ref_api.html">API Reference</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ref_api.html#android">Android</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ref_api.html#ios">iOS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ref_api.html#cordova">Cordova</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ref_api.html#xamarin">Xamarin</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../showcase-apps/index.html">Showcase Apps</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/service-setup.html">Service Setup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/identity-management.html">Identity Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/device-security.html">Device Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/push-notifications.html">Push Notifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../showcase-apps/metrics.html">Mobile Metrics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mobile-cli.html">Mobile CLI</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">AeroGear Docs</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">AeroGear Docs</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main" role="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="crumbs" role="navigation" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/aerogear/mobile-docs/edit/master/modules/ROOT/pages/push/ref_message-format.adoc"></a></div>
</div>
<article class="doc">
<div class="sect1">
<h2 id="about-the-push-notifications-message-format"><a class="anchor" href="#about-the-push-notifications-message-format"></a>About the Push Notifications message format</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sender"><a class="anchor" href="#sender"></a>Sender</h3>
<div class="literalblock">
<div class="content">
<pre>curl -u "{PushApplicationID}:{MasterSecret}"
   -v -H "Accept: application/json" -H "Content-type: application/json"
   -X POST
   -d '{
       "criteria": {
         "variants" : ["c3f0a94f-48de-4b77-a08e-68114460857e", "444939cd-ae63-4ce1-96a4-de74b77e3737" ....],
         "alias" : ["user@account.com", "someone@aerogear.org", ....],
         "categories" : ["someCategory", "otherCategory"],
         "deviceType" : ["iPad", "AndroidTablet"]
       },
       "message": {
         "alert":"HELLO!",
         "sound":"default",
         "badge":7,
         "content-available" : true,
         "action-category" : "some_category",
         "simple-push": "version=123",
         "user-data": {
            "someKey":"some value",
            "anotherCustomKey":"some other value"
         },
         "windows": {
            "type": "tile",
            "duration": "short",
            "badge": "alert",
            "tileType": "TileWideBlockAndText01",
            "images": ["Assets/test.jpg", "Assets/background.png"],
            "textFields": ["foreground text"]
          },
       },
       "config": {
         "ttl" : 3600,
       }
     }'

https://SERVER:PORT/CONTEXT/rest/sender</pre>
</div>
</div>
<div class="sect3">
<h4 id="message-format"><a class="anchor" href="#message-format"></a>Message Format</h4>
<div class="paragraph">
<p>The message format is very simple: A generic JSON map is used to sent
messages to Android, iOS and Windows devices.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ttl</code> Specifies in seconds the <code>time-to-live</code> for the submitted
notification. This value is supported by APNs and GCM. If a device is
offline for a longer time than specified by the <code>ttl</code> value, the
supported Push Networks may not deliver the notification.</p>
</li>
<li>
<p><code>content-available</code> is an iOS specific argument to mark the payload as
'content-available'. The feature is needed when sending notifications to
Newsstand applications and submitting silent iOS notifications (iOS7)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="message-object"><a class="anchor" href="#message-object"></a>Message Object</h4>
<div class="paragraph">
<p>The applications on the devices will receive the JSON map and are
responsible for performing a lookup to read values of the given keys.</p>
</div>
<div class="sect4">
<h5 id="ios-special-keys"><a class="anchor" href="#ios-special-keys"></a>iOS special keys</h5>
<div class="paragraph">
<p>If the JSON map contains one of the following reserved keywords, Apple
specific hooks will be invoked on the device:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>alert</code> (triggers a dialog, displaying the value - no iOS API needs to
be invoked by the app developer)</p>
</li>
<li>
<p><code>sound</code> (plays a given sound - no iOS API needs to be invoked by the
app developer)</p>
</li>
<li>
<p><code>badge</code> (sets the value of the badge icon - no iOS API needs to be
invoked by the app developer)</p>
</li>
<li>
<p><code>content-available</code> (iOS7 feature for submitting silent iOS
notifications)</p>
</li>
<li>
<p><code>action-category</code> (iOS8 feature for interactive notifications)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="android-special-keys"><a class="anchor" href="#android-special-keys"></a>Android special keys</h5>
<div class="paragraph">
<p>None! The JSON map is submitted as it is, directly to the device. There
are no Android specific keywords.</p>
</div>
</div>
<div class="sect4">
<h5 id="cordova-android-special-keys"><a class="anchor" href="#cordova-android-special-keys"></a>Cordova Android special keys</h5>
<div class="paragraph">
<p>To make the user experience the same on iOS and Android, for cordova
users, we use the iOS alert 'key' on Android as well to generate a
notification for you. And we&#8217;ve introduced a 'title' that can optionally
be used for the title of this notification, if none is specified the
application name will be used like on iOS.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="simplepush-object"><a class="anchor" href="#simplepush-object"></a>SimplePush Object</h4>
<div class="paragraph">
<p>For SimplePush an extra <code>simple-push</code> object is provided. This key is
only used for SimplePush variants. The version is submitted to all
connected client, that are subscribed on their matching channels.</p>
</div>
</div>
<div class="sect3">
<h4 id="query-component"><a class="anchor" href="#query-component"></a>Query component</h4>
<div class="paragraph">
<p>Currently the Server will support the following query criteria:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>variants</code>: A list of one or more <em>mobile variant ID&#8217;s</em> to identify a
particular PushApplication variant (e.g. HR Android, HR iPad).</p>
</li>
<li>
<p><code>alias</code>: A list of one or more <em>identifiers</em> (such as <code>email</code> or
<code>username</code>) to send messages to <em>ALL</em> devices of the user(s). The
<code>alias</code> needs to be stored, when the device is registering itself with
the server.</p>
</li>
<li>
<p><code>categories</code>: Helps to <em>tag</em> the current client with multiple
categories. Gives a semantic meaning to a registered <code>Installation</code>.</p>
</li>
<li>
<p><code>deviceType</code>: A list of raw device types that should receive the
message (e.g. Coupon only for iPad and AndroidTablets). The <code>deviceType</code>
needs to be stored when the device is registering itself with the
server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>*NOTE:*</em> All these query criterias are optional. If no criterias are
passed it will act as a <em>broadcast</em> send, where <em>all</em> clients are
notified.</p>
</div>
</div>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>This is a preview of the https://docs.aerogear.org website.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script src="../../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
