<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untitled :: AeroGear</title>
    <link rel="canonical" href="https://www.aerogear.org/android-sdk/latest/getting-started/auth-user-attributes.html">
    <meta name="generator" content="Antora 1.0.0">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.aerogear.org">AeroGear</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="/">Home</a>
        <a class="navbar-item" href="../../processes/latest/index.html">Community Guides</a>        
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Mobile Platform</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../android/latest/index.html">Android</a>
            <a class="navbar-item" href="../../ios/latest/index.html">iOS</a>
            <a class="navbar-item" href="../../cordova/latest/index.html">Cordova</a>
            <a class="navbar-item" href="../../xamarin/latest/index.html">Xamarin</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="../../metrics/latest/index.html">Metrics</a>
            <a class="navbar-item" href="../../push/latest/index.html">Push</a>
            <a class="navbar-item" href="../../idm/latest/index.html">Identity</a>       
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="android-sdk" data-version="latest">
  <aside class="navigation" role="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">AeroGear Android SDK</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="getting-started.html">Getting Started with AeroGear Android SDK</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="core.html">Using the AeroGear Android SDK</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="metrics.html">Using the Android SDK with the Metrics Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="auth.html">Using the Android SDK with the Auth Service</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">AeroGear Android SDK</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">AeroGear</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../aerogear/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">AeroGear Android SDK</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">AeroGear Metrics Mobile Service</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../metrics/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">AeroGear Processes</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../processes/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../processes/v0.0.1/index.html">v0.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">AeroGear Push Mobile Service</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../push/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main" role="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../../aerogear/latest/index.html" class="home-link"></a>
<nav class="crumbs" role="navigation" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="file:///home/pwright/repos/aerogear/aerogear-android-sdk/docs/modules/getting-started/pages/auth-user-attributes.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<div class="sect1">
<h2 id="accessing-custom-keycloak-user-attributes"><a class="anchor" href="#accessing-custom-keycloak-user-attributes"></a>Accessing Custom Keycloak User Attributes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Keycloak allows creating custom <a href="http://www.keycloak.org/docs/latest/server_admin/index.html#user-attributes">User Attributes</a> on top of the default attributes that OpenID Connect provides.
By default, these are not exposed in the Identity or Access tokens. You will need to use the Keycloak <a href="http://www.keycloak.org/docs/latest/server_admin/index.html#_protocol-mappers">Token Mapper</a> to define any extra attributes that you want in the tokens.</p>
</div>
<div class="sect2">
<h3 id="setting-user-attributes"><a class="anchor" href="#setting-user-attributes"></a>Setting User Attributes</h3>
<div class="paragraph">
<p>User attributes can be added under the <strong>Attributes</strong> tab of a <strong>User</strong>. Here you can define any attributes you want. In this example, I created the Key <code>customAttribute</code> with the Value <code>test</code>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/shared/keycloak-user-attributes.png" alt="keycloak user attributes"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="configuring-the-token-mapper"><a class="anchor" href="#configuring-the-token-mapper"></a>Configuring the Token Mapper</h3>
<div class="paragraph">
<p>The next step we need to do is to allow this attribute to be sent in the tokens. To do this, we need to choose our <strong>Client</strong> and then select the <strong>Mappers</strong> tab.
Then click the <strong>Create</strong> button to create a new token mapper. Choose the Name of the mapper, the User Attribute it references (in this case we chose <code>customAttribute</code>) and then choose a Token Claim Name.
The Token Claim Name is the Key name that the User Attribute will be shown under in the JSON in the decoded Token. You should then set the Claim JSON Type to match the type of data your User Attribute is.
Optionally, you can also specify which tokens you want this attribute to be sent in.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/shared/keycloak-token-mapper.png" alt="keycloak token mapper"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="inspecting-our-token"><a class="anchor" href="#inspecting-our-token"></a>Inspecting Our Token</h3>
<div class="paragraph">
<p>In we authenticate in our client application, we can now see that the <code>customAttribute</code> is being included in the Identity/Access Tokens.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>{
...
"customAttribute":"test",
"name":"User 1",
"preferred_username":"user1",
"given_name":"User",
"family_name":"1",
"email":"user1@feedhenry.org"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>This is a preview of the https://docs.aerogear.org website.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script src="../../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
